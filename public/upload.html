<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="stylesheet" type="text/css" href="style.css"/>
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Questrial"/>
<link rel="icon" type="image/png" href="favicon.png"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<title>Bleippsons</title>

<style></style>
</head>

<body>

<!-- Navigation -->
<nav>
    <ul class="w3-navbar w3-black">
        <li><a href="index.html">Home</a></li>
        <li><a href="welcome.html">Welcome</a></li>
        <li><a href="memories.html">Memories</a></li>
        <li><a href="#" style="font-weight:bold">Upload</a></li>
    </ul>
</nav>


<!-- Upload -->
<div id="upload-headline">
    <div class="container">
        <div>
            <h1><span><br><br>Show us yours!</span></h1>
            <p>always room for more Bleippson memories</p>
            <input id="memory-title" type="text" placeholder="memory title"></input><br>

            <form action="https://api.cosmicjs.com/v1/matttea-blog-app/media" method="post" enctype="multipart/form-data">
                <input type="file" name="media" id="image-file" />
                <input type="submit" value="Upload" />
            </form>

            <!-- <input type="file" name="media" id="image-file" />             -->

            <input type="date" id="memory-date" value="2023-03-23"></input><br>
            <input id="memory-content" type="text" placeholder="memory description"/></input><br><br>
            <button id="upload-button" class="small-button">upload</button>
            <p>(coming soon)</p>          
        </div>
    </div>
</div>


<!-- Footer -->
<footer id="footer">
    <div class="container" style="text-align:center">
        <p>Bleippsons | 2023</p>
    </div>
</footer>



</body>

<script>
//when page has fully rendered then execute this code
$(document).ready(function () {

    //POST /memories to Cosmic
    $("#upload-button").click(function (element) {
        
        var memoryTitle = $("#memory-title").val();
        // var memoryImage;
        var memoryDate = $("#memory-date").val();
        var memoryContent = $("#memory-content").val();

        var memoryParams = {
            title: memoryTitle,
            type_slug: 'memories',
            content: memoryContent,
            metafields: [{
                key: 'headline',
                type: 'text',
                value: memoryTitle                
            }, {
                key: 'memory_date',
                type: 'date',
                value: memoryDate
            }]
        };

        var memoryParamsJson = JSON.stringify(memoryParams);
        console.log('memoryParamsJson: ' + memoryParamsJson);
        var apiPost = "https://api.cosmicjs.com/v1/matttea-blog-app/add-object";
        
        $.ajax({
            type: "POST",
            url: apiPost,
            data: JSON.stringify(memoryParams),
            contentType: "application/json",
            success: function(data){
                console.log('success: ' + data);
            },
            failure: function(errMsg) {
                console.log('errorMsg: ' + errMsg);
            }
        });

        // var memoryImage = $('#image-file');
        // // COMMENT var memoryImage = document.getElementById('image-file');
        // // COMMENT var memoryImageFile = memoryImage.file;
        // var imagePost = "https://api.cosmicjs.com/v1/matttea-blog-app/media";

        // $.ajax({
        //     type: "POST",
        //     url: imagePost,
        //     // COMMENT data: memoryImage,
        //     media: memoryImage,
        //     // COMMENT media: "your-media-multipart-form-data",
        //     // COMMENT processData: false,
        //     contentType: "multipart/form-data",
        //     // COMMENT crossDomain : true,
        //     // COMMENT contentType: false,
        //     success: function(data){
        //         console.log('success: ' + data);
        //     },
        //     failure: function(errMsg) {
        //         console.log(errMsg);
        //     }            
        // });

        // COMMENT Empty all input fields after upload
        $("#memory-title").val('');
        // COMMENT $("#image-file").val('');
        $("#memory-date").val('');
        $("#memory-content").val('');

        // TODO make menu smaller or roll up when in narrow viewport
        // TODO adjust text sizing on upload page in narrow viewport <p> text is bigger than header
    });

});


</script>



</html>